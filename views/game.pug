extends template

block head
    script(type="module" src="/js/client/game.js" defer)

block main
    .game-header
        .header-unified-bar
            .header-section.identity
                span.game-id ID: #{game_id}
                span.player-name-display #{player_name}

            .header-section.phase-logic
                span.phase-label.trading üîÑ LOADING...
                #timer.timer --:--
                .players-status 0/0
                .turn-status WAITING...

            .header-section.progress-exit
                span.round-display Round 1/1
                button#leaveBtn.btn-leave LEAVE

    .action-form
        .form-row.three-columns
            .form-column.column-roll
                button#btnRollDice.btn-roll-ready(disabled) ‚è≥ Loading...

            .form-column.column-trade
                .trade-form
                    .trade-controls
                        select#stockSelect.stock-select
                            option(value="Gold" style="background-color: #fde68a;") Gold
                            option(value="Silver" style="background-color: #d8dcdf;") Silver
                            option(value="Oil" style="background-color: #b3bce5;") Oil
                            option(value="Bonds" style="background-color: #a8d2f0;") Bonds
                            option(value="Industrials" style="background-color: #dcc2e8;") Industrials
                            option(value="Grain" style="background-color: #f6bfa6;") Grain

                        .amount-controls
                            .custom-number-input
                                input#amountInput.amount-input(
                                    type="number"
                                    value="500"
                                    class="amount-input"
                                    readonly
                                )
                                .spin-buttons
                                    button.spin-btn.spin-up ‚ñ≤
                                    button.spin-btn.spin-down ‚ñº
                            .share-quick-buttons
                                button.qty-btn(data-amount="500") 500
                                button.qty-btn(data-amount="1000") 1K
                                button.qty-btn(data-amount="2000") 2K
                                button.qty-btn(data-amount="5000") 5K

                        input#costDisplay.cost-display(
                            type="text"
                            value="COST: $0.00"
                            readonly
                        )

                        .trade-action-buttons
                            button#btnBuy.btn-buy(disabled) Buy
                            button#btnSell.btn-sell(disabled) Sell

            .form-column.column-done
                .done-trading-section
                    .done-trading-control
                        .checkbox-header
                            label Done Trading?
                        .checkbox-wrapper
                            input#doneTradingCheckbox(
                                type="checkbox"
                                style="display:none;"                               
                                disabled
                            )
                            label.checkbox-label(for="doneTradingCheckbox")
                                .checkbox-box
                                    span.checkmark ‚úì

    #stocksDisplay.stocks_display
        table.stock-price-table
            thead
                tr
                    th.corner-cell
                    - for (let p = 0; p <= 200; p += 5)
                        - const is_special = [0, 100, 200].includes(p);
                        th(class=is_special ? 'price-header-special' : 'price-header') #{p}
            tbody
                -
                    const rows = [
                        { name: 'Gold', class: 'gold', display: 'Gold' },
                        { name: 'Silver', class: 'silver', display: 'Silver' },
                        { name: 'Oil', class: 'oil', display: 'Oil' },
                        { name: 'Bonds', class: 'bonds', display: 'Bonds' },
                        { name: 'Industrials', class: 'industrials', display: 'Indust.' },
                        { name: 'Grain', class: 'grain', display: 'Grain' }
                    ];
                each row in rows
                    tr(class=`stock-row ${row.class}-row`)
                        th(class=`stock-header ${row.class}-header`) #{row.display}
                        - for (let pC = 0; pC <= 200; pC += 5)
                            - const special = [0, 100, 200].includes(pC);
                            - const label = pC === 0 ? 'Off Market' : (pC === 100 ? 'Par' : (pC === 200 ? 'Split' : ''));
                            td(
                                class=`price-cell ${special ? 'price-cell-special' : ''}`
                                data-stock=row.name
                                data-price=pC
                                data-label=label
                            )

    .players
        #playersContainer.players-container
            div(style="text-align: center; padding: 40px; color: #666;") Loading players...

    #historyBar.history-bar
        .history-header(onclick="")
            span.history-title üìú Game History
            span#historyToggle.history-toggle ‚ñº
        #historyContent.history-content
            .history-empty Connecting...

    #dice-overlay.dice-overlay(style="display: none;")
        .dice-tray
            #die-stock.die ?
            #die-action.die ?
            #die-amount.die ?
        #dice-text.dice-result-text Rolling...